---
title: "Reproducible Research: Peer Assessment 1"
author: 'Atharva Rmagirkar'
date: 'July 7th, 2020'
output: 
  html_document:
    keep_md: true
---

#### A default setting for all the chunks in this Rmd file

```{r_setup,include=FALSE}
knitr::opts_chunk$set(echo = TRUE,cache = TRUE)
```

#### load the necessary libraries

```{r_load_lib}
library(plyr)
library(ggplot2)
```

-------------------

## Loading and preprocessing the data

```{r_load_process}
unzip(zipfile = "activity.zip", exdir = ".")
activity <- read.csv(file = "activity.csv", header = TRUE)
activity$date<-as.Date(x = activity$date, format = "%Y-%m-%d")
```

------------------------

## What is mean total number of steps taken per day?

```{r_meansteps}
Perday<-ddply(activity,
              .(date),
              summarize,
              totalsteps=sum(steps))
plot_one<-qplot(Perday$totalsteps,
                binwidth=1000,
                geom = "histogram",
                xlab = "total number of steps",
                ylab = "frequency",
                main = "Total steps daily before replacing NA values")
print(plot_one)
```

#### the Mean and the Median are:-

```{r_mean_median_display}
mean(Perday$totalsteps,na.rm = TRUE)
median(Perday$totalsteps,na.rm = TRUE)
```

--------------------

## What is the average daily activity pattern?

```{r_interval_avgsteps}
interval_avg <- ddply(activity,
                      .(interval),
                      summarize,
                      avgsteps=mean(steps,
                                    na.rm = TRUE))

plot_two<-plot(x = interval_avg$interval,
               y = interval_avg$avgsteps,
               type = "l")
print(plot_two)
```

--------------------

## Imputing missing values

#### First check the number of missing values

```{r_check_missing}
print("total number of missing values are:-")
sum(is.na(activity$steps))
```

```{r_missing_vals}

int_avgs<-rep(interval_avg$avgsteps,length(activity$steps)/length(interval_avg$interval))
activity$avgs<-int_avgs
inputNas= function(steps, avgs) 
{
  if (is.na(steps)) 
  { 
    return(avgs)
  }
  return(steps)
}


filled_data = activity
filled_data$steps = mapply(inputNas,
                           filled_data$steps,
                           filled_data$avgs)

```

#### Check the number of missing values again

```{r_recheck_missing}

print("total number of missing values are:-")
sum(is.na(filled_data$steps))

```

#### Make a histogram without any missing values 

```{r_plot_without_missing}
perday.filled<-ddply(filled_data,.(date),summarize,totalsteps=sum(steps))
plot_three<-qplot(perday.filled$totalsteps,
                  binwidth=1000,
                  geom = "histogram",
                  xlab = "total number of steps",
                  ylab = "frequency",
                  main = "Total steps daily after replacing NA values")
print(plot_three)

```

-------------------

## Are there differences in activity patterns between weekdays and weekends?

```{r_week_days}

which_day<-function(day)
  {
  
    if(day %in% c("Monday","Tuesday","Wednesday","Thursday","Friday"))
      {
        return("Weekday")
      }
    else if(day %in% c("Saturday","Sunday"))
      {
        return("Weekend")
      }
    else
      {
        stop("Invalid Day")
      }

  }

activity$week<-sapply(X = weekdays(activity$date),FUN = which_day,simplify = TRUE)
filled_data$week<-activity$week

interval_avg.filled<-ddply(filled_data,.(interval,week),summarise,totalsteps=mean(steps))

plot_four<-ggplot(interval_avg.filled, aes(interval, totalsteps)) + geom_line() + facet_grid(week ~ .) + xlab("5 minute interval") + ylab("total steps")  
print(plot_four)

```

------------
